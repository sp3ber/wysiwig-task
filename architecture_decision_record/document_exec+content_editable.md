# Использование связки documentExec и contentEditable для реализации WYSIWIG редактора

## Контекст

Для реализации WYSIWIG редактора есть несколько вариантов реализации:

- использование готовой библиотеки (например draft.js)
- написание самостоятельного решения.

Так как использовать готовое решение согласно условиям задачи было нельзя, необходимо было написать собственную реализацию. У этого варианта также есть несколько опций:

- designMode + iframe (https://developer.mozilla.org/ru/docs/Web/API/Document/designMode )
- связка contentEditable и document.execCommand (https://developer.mozilla.org/ru/docs/Web/API/Document/execCommand)
- реализация собственного решения с полным рендером выделения, позиций курсора и проч (подробнее - https://habr.com/ru/company/oleg-bunin/blog/350252/)

## Почему принято решение

- Реализовывать собственное решение с полным рендером состояния редактора было нецелесообразно по времени и затратам,
- designMode показался уж слишком устаревшим
- решение с contentEditable + document.execCommand показалось самым целесообразным из-за большого количества примеров и уже исследованных проблем с contentEditable.

## Последствия

Начну с минусов:

- состояние редактора по сути хранится в DOM (так как мы исполняем команды в контексте элемента с contentEditable)
- есть разница в обработке команд в браузере
- JSDOM не поддерживает ни в каком виде document.execCommand (https://github.com/jsdom/jsdom/issues/1539, https://github.com/jsdom/jsdom/issues/1742), поэтому тестировать функциональность приходиться на моках

Плюсы:

- это работает:)
- фактическая реализация заняла меньше одного дня
- небольшое количество кода (один файл ~300 строк кода)
